<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KTL Configuration Generator</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <style>
        .container {
            margin-top: 20px;
        }

        h2 {
            margin-bottom: 20px;
            font-size: 1.6rem;
        }

        .form-control {
            /*width: unset !important;*/
        }

        /* Style adjustments for inline label-input pairs */
        .form-inline {
            display: block;
            align-items: center;
            margin-bottom: 10px; /* Spacing between each form group */
        }

            .form-inline label {
                margin-right: 10px; /* Spacing between label and input */
                justify-content: left;
                /*min-width: 16em;*/
            }

            .form-inline .form-control {
                display: inline-block;
                width: 100%;
                vertical-align: middle;
            }

        /* Adjustments for checkbox groups to align items */
        .checkbox-group {
            display: flex;
            flex-direction: column;
        }

        .checkbox-inline {
            display: flex;
            align-items: center; /* Align checkbox and its label */
            margin-bottom: 5px; /* Spacing between each checkbox */
        }

            .checkbox-inline label {
                margin-right: 5px;
                margin-bottom: 0; /* Override Bootstrap's default bottom margin for labels */
            }

        label {
            margin-bottom: .1rem;
        }

        /* Additional CSS for background colors */
        .fieldset-color-1 {
            background-color: #f0f8ff;
        }
        /* AliceBlue */
        .fieldset-color-2 {
            background-color: #e6e6fa;
        }
        /* Lavender */
        .fieldset-color-3 {
            background-color: #f5f5dc;
        }
        /* Beige */
        .fieldset-color-4 {
            background-color: #fffacd;
        }
        /* LemonChiffon */
        .fieldset-color-5 {
            background-color: #e0ffff;
        }
        /* LightCyan */
        .fieldset-color-6 {
            background-color: #fafad2;
        }
        /* LightGoldenRodYellow */
        .fieldset-color-7 {
            background-color: #d6e5e0;
        }
        /* Light Green */

        /* Adjust the positioning of legends */
        fieldset legend {
            position: relative;
            top: 20px;
            background: unset;
            padding: 0 5px;
            width: auto;
            font-size: 1.2rem;
        }

        #grabber {
            width: 25px;
            height: 100%;
            background-color: #ccc;
            border-top-left-radius: 5px;
            border-bottom-left-radius: 5px;
            position: absolute;
            left: 0px;
            top: 50%;
            transform: translateY(-50%);
            cursor: grab;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 4px; /* Adjust the padding to center the dots correctly */
        }

        .dot-container {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin: 2px 0; /* Adjust the margin to set the vertical spacing between the dots */
        }

        .dot {
            width: 6px; /* Adjust size as needed */
            height: 6px; /* Adjust size as needed */
            background-color: #666;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>KTL Configuration Utility</h2>
        <button type="button" id="saveToFileBtn" class="btn btn-primary">Save to File</button>
        <button type="button" id="loadFromFileBtn" class="btn btn-primary">Load from File</button>
        <input type="file" id="fileInput" accept=".ktlcfg" style="display:none;">

        <form id="ktlConfigForm">
            <!-- Group: Core Settings -->
            <fieldset class="form-group border p-3">
                <legend>Core Settings</legend>
                <div>
                    <label>Developer Names (comma-separated):</label>
                    <input type="text" class="form-control" id="developerNames" placeholder="Firstname Lastname">
                </div>
                <div>
                    <label>Developer Email:</label>
                    <input type="email" class="form-control" id="developerEmail" placeholder="yourmail@provider.com">
                </div>
                <div>
                    <label>Developer Options PIN:</label>
                    <input type="text" class="form-control" id="devOptionsPin" placeholder="0000">
                </div>
            </fieldset>

            <!-- Group: Main KTL Feature Switches -->
            <fieldset class="form-group border p-3">
                <legend>General Feature Settings</legend>

                <!-- Sub-Group: Feature Switches -->
                <fieldset class="form-group border p-3">
                    <legend>Version Info Bar</legend>
                    <div class="checkbox-inline">
                        <label for="viShowAppInfo">Show App Info</label>
                        <input type="checkbox" id="viShowAppInfo" checked><br>
                    </div>
                    <div class="checkbox-inline">
                        <label for="viShowKtlInfo">Show KTL Info</label>
                        <input type="checkbox" id="viShowKtlInfo" checked><br>
                    </div>
                    <div class="form-inline">
                        <label for="viShowToRoles">Show to these roles only</label>
                        <input type="text" class="form-control" id="viShowToRoles" placeholder="Developer" value="Developer">
                    </div>
                    <div class="form-inline">
                        <label for="viPosX">Default Horizontal Pos</label>
                        <select class="form-control" id="viPosX">
                            <option value="right">Right</option>
                            <option value="center">Center</option>
                            <option value="left">Left</option>
                        </select>
                    </div>
                    <div class="form-inline">
                        <label for="viPosY">Default Vertical Position</label>
                        <select class="form-control" id="viPosY">
                            <option value="top">Top</option>
                            <option value="bottom">Bottom</option>
                        </select>
                    </div>
                    <div class="form-inline">
                        <label for="viPosXMobile">Mobile Horizontal Pos</label>
                        <select class="form-control" id="viPosXMobile">
                            <option value="center">Center</option>
                            <option value="left">Left</option>
                            <option value="right">Right</option>
                        </select>
                    </div>
                    <div class="form-inline">
                        <label for="viPosYMobile">Mobile Vertical Position</label>
                        <select class="form-control" id="viPosYMobile">
                            <option value="bottom">Bottom</option>
                            <option value="top">Top</option>
                        </select>
                    </div>

                    <div class="form-inline">
                        <label for="viOpacity">Default Opacity</label>
                        <input type="number" class="form-control" id="viOpacity" placeholder="50" value="50">
                    </div>
                    <div class="form-inline">
                        <label for="viOpacityHover">Opacity on Hover</label>
                        <input type="number" class="form-control" id="viOpacityHover" placeholder="100" value="100">
                    </div>
                </fieldset>

                <!-- Sub-Group: Feature Switches -->
                <fieldset class="form-group border p-3">
                    <legend>Feature Switches</legend>
                    <div class="checkbox-inline">
                        <label for="showMenuInTitle">Show Menu in Title</label>
                        <input type="checkbox" id="showMenuInTitle" checked>
                    </div>
                    <div class="checkbox-inline">
                        <label for="selTextOnFocus">Select Text on Focus</label>
                        <input type="checkbox" id="selTextOnFocus" checked>
                    </div>
                    <!-- Inline Edit Color -->
                    <div class="checkbox-inline">
                        <label for="inlineEditColor">Inline Edit Color</label>
                        <input type="checkbox" id="inlineEditColor" checked>
                    </div>
                    <!-- Row Hover Highlight -->
                    <div class="checkbox-inline">
                        <label for="rowHoverHighlight">Row Hover Highlight</label>
                        <input type="checkbox" id="rowHoverHighlight" checked>
                    </div>
                    <!-- Auto Focus -->
                    <div class="checkbox-inline">
                        <label for="autoFocus">Auto Focus</label>
                        <input type="checkbox" id="autoFocus" checked>
                    </div>
                    <!-- Sorted Menus -->
                    <div class="checkbox-inline">
                        <label for="sortedMenus">Sorted Menus</label>
                        <input type="checkbox" id="sortedMenus" checked>
                    </div>
                    <!-- User Filters -->
                    <div class="checkbox-inline">
                        <label for="userFilters">User Filters</label>
                        <input type="checkbox" id="userFilters" checked>
                    </div>
                    <!-- Persistent Form -->
                    <div class="checkbox-inline">
                        <label for="persistentForm">Persistent Form</label>
                        <input type="checkbox" id="persistentForm" checked>
                    </div>
                    <!-- Calendar Go To Date -->
                    <div class="checkbox-inline">
                        <label for="calendarGotoDate">Calendar Go To Date</label>
                        <input type="checkbox" id="calendarGotoDate" checked>
                    </div>
                    <!-- Remember Me -->
                    <div class="checkbox-inline">
                        <label for="rememberMe">Remember Me</label>
                        <input type="checkbox" id="rememberMe" checked>
                    </div>
                    <!-- Form Pre Validation -->
                    <div class="checkbox-inline">
                        <label for="formPreValidation">Form Pre Validation</label>
                        <input type="checkbox" id="formPreValidation" checked>
                    </div>
                    <!-- Spinner Watch Dog -->
                    <div class="checkbox-inline">
                        <label for="spinnerWatchDog">Spinner Watch Dog</label>
                        <input type="checkbox" id="spinnerWatchDog" checked>
                    </div>
                    <!-- Idle Watch Dog -->
                    <div class="checkbox-inline">
                        <label for="idleWatchDog">Idle Watch Dog</label>
                        <input type="checkbox" id="idleWatchDog" checked>
                    </div>
                    <!-- Debug Window -->
                    <div class="checkbox-inline">
                        <label for="debugWnd">Debug Window</label>
                        <input type="checkbox" id="debugWnd" checked>
                    </div>
                    <!-- Dev Info Popup -->
                    <div class="checkbox-inline">
                        <label for="devInfoPopup">Dev Info Popup</label>
                        <input type="checkbox" id="devInfoPopup" checked>
                    </div>
                    <!-- Dev Pause Auto Refresh -->
                    <div class="checkbox-inline">
                        <label for="devPauseAutoRefresh">Dev Pause Auto Refresh</label>
                        <input type="checkbox" id="devPauseAutoRefresh" checked>
                    </div>
                    <!-- Virtual Keyboard -->
                    <div class="checkbox-inline">
                        <label for="virtualKeyboard">Virtual Keyboard</label>
                        <input type="checkbox" id="virtualKeyboard">
                    </div>
                    <!-- iFrameWnd -->
                    <div class="checkbox-inline">
                        <label for="iFrameWnd">iFrameWnd</label>
                        <input type="checkbox" id="iFrameWnd">
                    </div>
                </fieldset>

                <!-- Bulk Operations -->
                <fieldset class="form-group border p-3">
                    <legend>Bulk Operations</legend>
                    <div class="checkbox-inline">
                        <label for="bulkEdit">Bulk Edit</label>
                        <input type="checkbox" id="bulkEdit" checked>
                    </div>
                    <div class="checkbox-inline">
                        <label for="bulkCopy">Bulk Copy</label>
                        <input type="checkbox" id="bulkCopy" checked>
                    </div>
                    <div class="checkbox-inline">
                        <label for="bulkDelete">Bulk Delete</label>
                        <input type="checkbox" id="bulkDelete" checked>
                    </div>
                </fieldset>


                <!-- Sub-Group: Popup Style Settings -->
                <fieldset class="form-group border p-3">
                    <legend>Popup Style</legend>
                    <div class="form-inline">
                        <label for="popupStyleSuccess">Success Style</label>
                        <input type="text" class="form-control" id="popupStyleSuccess" value=";background-color:#81b378;border:5px solid #294125">
                    </div>
                    <div class="form-inline">
                        <label for="popupStyleWarning">Warning Style</label>
                        <input type="text" class="form-control" id="popupStyleWarning" value=";background-color:#fffa5e;border:2px solid #7e8060">
                    </div>
                    <div class="form-inline">
                        <label for="popupStyleError">Error Style</label>
                        <input type="text" class="form-control" id="popupStyleError" value=";background-color:#FFB0B0;border:5px solid #660000">
                    </div>
                </fieldset>

                <!-- Sub-Group: Tooltip Styles Settings -->
                <fieldset class="form-group border p-3">
                    <legend>Tooltip Styles</legend>
                    <div class="form-inline">
                        <label for="ktlTtipFormViewBgColor">Form View Background Color</label>
                        <input type="text" class="form-control" id="ktlTtipFormViewBgColor" value="#222222">
                    </div>
                    <div class="form-inline">
                        <label for="ktlTtipFormViewTxtColor">Form View Text Color</label>
                        <input type="text" class="form-control" id="ktlTtipFormViewTxtColor" value="#ffffff">
                    </div>
                    <div class="form-inline">
                        <label for="ktlTtipIconFormViewColor">Form View Icon Color</label>
                        <input type="text" class="form-control" id="ktlTtipIconFormViewColor" value="#222222">
                    </div>
                    <div class="form-inline">
                        <label for="ktlTtipDetailsViewBgColor">Details/List View Background Color</label>
                        <input type="text" class="form-control" id="ktlTtipDetailsViewBgColor" value="#222222">
                    </div>
                    <div class="form-inline">
                        <label for="ktlTtipDetailsViewTxtColor">Details/List View Text Color</label>
                        <input type="text" class="form-control" id="ktlTtipDetailsViewTxtColor" value="#ffffff">
                    </div>
                    <div class="form-inline">
                        <label for="ktlTtipIconDetailsViewColor">Details/List View Icon Color</label>
                        <input type="text" class="form-control" id="ktlTtipIconDetailsViewColor" value="#222222">
                    </div>
                    <div class="form-inline">
                        <label for="ktlTtipTableViewBgColor">Table View Background Color</label>
                        <input type="text" class="form-control" id="ktlTtipTableViewBgColor" value="#222222">
                    </div>
                    <div class="form-inline">
                        <label for="ktlTtipTableViewTxtColor">Table View Text Color</label>
                        <input type="text" class="form-control" id="ktlTtipTableViewTxtColor" value="#ffffff">
                    </div>
                    <div class="form-inline">
                        <label for="ktlTtipIconTableViewColor">Table View Icon Color</label>
                        <input type="text" class="form-control" id="ktlTtipIconTableViewColor" value="#222222">
                    </div>
                </fieldset>
            </fieldset>

            <!-- Group: Scenes Settings -->
            <fieldset class="form-group border p-3">
                <legend>Scenes</legend>
                <div class="form-inline">
                    <label for="versionDisplayName">Version Display Name</label>
                    <input type="text" class="form-control" id="versionDisplayName" placeholder="CTRND">
                </div>
                <div class="form-inline">
                    <label for="idleWatchDogDelay">Idle WatchDog Delay (ms)</label>
                    <input type="number" class="form-control" id="idleWatchDogDelay" value="7200000" placeholder="120 * 60000">
                </div>
                <div class="form-inline">
                    <label for="spinnerCtrDelay">Spinner Control Delay (seconds)</label>
                    <input type="number" class="form-control" id="spinnerCtrDelay" value="60" placeholder="60">
                </div>
                <div class="form-inline">
                    <label for="spinnerWdExcludeScn">Spinner WatchDog Exclude Scenes (comma-separated IDs)</label>
                    <input type="text" class="form-control" id="spinnerWdExcludeScn" placeholder="1,2,3">
                </div>
            </fieldset>

            <!-- Group: Views Settings -->
            <fieldset class="form-group border p-3">
                <legend>Views</legend>

                <fieldset class="form-group border p-3">
                    <legend>Quick Toggle Params</legend>
                    <div class="form-inline">
                        <label for="bgColorTrue">Background Color (True)</label>
                        <input type="text" class="form-control" id="bgColorTrue" value="#39d91f">
                    </div>
                    <div class="form-inline">
                        <label for="bgColorFalse">Background Color (False)</label>
                        <input type="text" class="form-control" id="bgColorFalse" value="#f04a3b">
                    </div>
                    <div class="form-inline">
                        <label for="bgColorPending">Background Color (Pending)</label>
                        <input type="text" class="form-control" id="bgColorPending" value="#dd08">
                    </div>
                    <div class="checkbox-inline">
                        <label for="showSpinner">Show Spinner</label>
                        <input type="checkbox" id="showSpinner" checked>
                    </div>
                    <div class="checkbox-inline">
                        <label for="showNotification">Show Notification</label>
                        <input type="checkbox" id="showNotification" checked>
                    </div>
                </fieldset>

                <div class="checkbox-inline">
                    <label for="headerAlignment">Header Alignment</label>
                    <input type="checkbox" id="headerAlignment" checked>
                </div>
                <div class="form-inline">
                    <label for="ktlFlashRate">KTL Flash Rate</label>
                    <input type="text" class="form-control" id="ktlFlashRate" value="1">
                </div>
                <div class="form-inline">
                    <label for="ktlOutlineColor">KTL Outline Color</label>
                    <input type="text" class="form-control" id="ktlOutlineColor" value="green">
                </div>
                <div class="form-inline">
                    <label for="hscCollapsedColumnsWidth">HSC Collapsed Columns Width (in pixels)</label>
                    <input type="number" class="form-control" id="hscCollapsedColumnsWidth" value="5">
                </div>
                <div class="checkbox-inline">
                    <label for="hscGlobal">HSC Global</label>
                    <input type="checkbox" id="hscGlobal" checked>
                </div>
            </fieldset>

            <!-- Group: Fields Settings -->
            <fieldset class="form-group border p-3">
                <legend>Fields</legend>
                <div class="form-inline">
                    <label for="textAsNumeric">Text As Numeric (comma-separated field IDs)</label>
                    <input type="text" class="form-control" id="textAsNumeric" placeholder="Field IDs">
                </div>
                <div class="form-inline">
                    <label for="textAsNumericExcludeScenes">Exclude Scenes (comma-separated scene IDs)</label>
                    <input type="text" class="form-control" id="textAsNumericExcludeScenes" placeholder="Scene IDs">
                </div>
                <div class="checkbox-inline">
                    <label for="horizontalRadioButtons">Horizontal Radio Buttons</label>
                    <input type="checkbox" id="horizontalRadioButtons">
                </div>
                <div class="checkbox-inline">
                    <label for="horizontalCheckboxes">Horizontal Checkboxes</label>
                    <input type="checkbox" id="horizontalCheckboxes">
                </div>
                <div class="form-inline">
                    <label for="barcodeTimeout">Barcode Timeout (seconds)</label>
                    <input type="number" class="form-control" id="barcodeTimeout" value="20">
                </div>
                <div class="form-inline">
                    <label for="barcodeMinLength">Barcode Minimum Length</label>
                    <input type="number" class="form-control" id="barcodeMinLength" value="3">
                </div>
                <div class="checkbox-inline">
                    <label for="convertNumToTel">Convert Number to Tel</label>
                    <input type="checkbox" id="convertNumToTel" checked>
                </div>
            </fieldset>

            <!-- Group: Persistent Forms Settings -->
            <fieldset class="form-group border p-3">
                <legend>Persistent Forms</legend>
                <div class="form-inline">
                    <label for="persistentFormsScenesToExclude">Scenes to Exclude (comma-separated IDs)</label>
                    <input type="text" class="form-control" id="persistentFormsScenesToExclude" placeholder="1,2,3">
                </div>
                <div class="form-inline">
                    <label for="persistentFormsFieldsToExclude">Fields to Exclude (comma-separated IDs)</label>
                    <input type="text" class="form-control" id="persistentFormsFieldsToExclude" placeholder="field_1,field_2">
                </div>
            </fieldset>

            <!-- Group: System Colors Settings -->
            <fieldset class="form-group border p-3">
                <legend>System Colors</legend>
                <div class="form-inline">
                    <label for="inlineEditBkgColor">Inline Edit Background Color</label>
                    <input type="text" class="form-control" id="inlineEditBkgColor" placeholder="e.g., #ffffff or paleLowSatClrTransparent">
                </div>
                <div class="form-inline">
                    <label for="inlineEditFontWeight">Inline Edit Font Weight</label>
                    <input type="text" class="form-control" id="inlineEditFontWeight" placeholder="e.g., bold or 600">
                </div>
                <div class="form-inline">
                    <label for="tableRowHoverBkgColor">Table Row Hover Background Color</label>
                    <input type="text" class="form-control" id="tableRowHoverBkgColor" placeholder="e.g., #a0454b75 or mistyrose">
                </div>
            </fieldset>

            <!-- Group: Advanced Settings -->
            <fieldset class="form-group border p-3">
                <legend>Advanced Settings</legend>

                <!-- Sub-Group: iFrameWnd Settings -->
                <fieldset class="form-group border p-3">
                    <legend>iFrameWnd</legend>
                    <div class="checkbox-inline">
                        <label for="sendHeartbeat">Send Heartbeat</label>
                        <input type="checkbox" id="sendHeartbeat" checked>
                    </div>
                </fieldset>

                <!-- Advanced Settings' Sub-Group: Logging Settings -->
                <fieldset class="form-group border p-3">
                    <legend>Logging</legend>
                    <div class="checkbox-inline">
                        <label for="logCritical">Critical</label>
                        <input type="checkbox" id="logCritical">
                    </div>
                    <div class="checkbox-inline">
                        <label for="logError">Error</label>
                        <input type="checkbox" id="logError">
                    </div>
                    <div class="checkbox-inline">
                        <label for="logServerErr">Server Error</label>
                        <input type="checkbox" id="logServerErr">
                    </div>
                    <div class="checkbox-inline">
                        <label for="logWarning">Warning</label>
                        <input type="checkbox" id="logWarning">
                    </div>
                    <div class="checkbox-inline">
                        <label for="logInfo">Info</label>
                        <input type="checkbox" id="logInfo">
                    </div>
                    <div class="checkbox-inline">
                        <label for="logDebug">Debug</label>
                        <input type="checkbox" id="logDebug">
                    </div>
                    <div class="checkbox-inline">
                        <label for="logLogin">Login</label>
                        <input type="checkbox" id="logLogin">
                    </div>
                    <div class="checkbox-inline">
                        <label for="logActivity">Activity</label>
                        <input type="checkbox" id="logActivity">
                    </div>
                    <div class="checkbox-inline">
                        <label for="logNavigation">Navigation</label>
                        <input type="checkbox" id="logNavigation">
                    </div>
                </fieldset>

                <!-- Advanced Settings' Sub-Group: Kiosk Settings -->
                <fieldset class="form-group border p-3">
                    <legend>Kiosk</legend>

                    <div class="form-group">
                        <label>ADD_REFRESH Button Config</label>
                        <input type="text" class="form-control" id="addRefreshHtml" placeholder="HTML">
                        <input type="text" class="form-control" id="addRefreshId" placeholder="ID">
                        <input type="text" class="form-control" id="addRefreshHref" placeholder="Href Function">
                    </div>

                    <div class="form-group">
                        <label>ADD_BACK Button Config</label>
                        <input type="text" class="form-control" id="addBackHtml" placeholder="HTML">
                        <input type="text" class="form-control" id="addBackId" placeholder="ID">
                        <input type="text" class="form-control" id="addBackHref" placeholder="Href Function">
                    </div>

                    <div class="form-group">
                        <label>ADD_DONE Button Config</label>
                        <input type="text" class="form-control" id="addDoneHtml" placeholder="HTML">
                        <input type="text" class="form-control" id="addDoneId" placeholder="ID">
                        <input type="text" class="form-control" id="addDoneHref" placeholder="Href Function">
                    </div>
                </fieldset>

            </fieldset>

            <button type="button" class="btn btn-primary" id="generateConfigBtn">Generate Configuration</button>
        </form>

        <textarea id="generatedConfig" rows="100" class="form-control" style="margin-top: 20px; <!--width: 60em !important;-->"></textarea>
    </div>

    <div id="colorPickerContainer" style="cursor: move; position: fixed; top: 70px; right: 5%; background: gray; padding: 10px; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">

        <div id="grabber">
            <div class="dot-container">
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
            <div class="dot-container">
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
            <div class="dot-container">
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
        </div>

        <div style="width: 20px; height: 100%; position: absolute; left: 20px; top: 50%; transform: translateY(-50%); cursor: grab; border-top-left-radius: 5px; border-bottom-left-radius: 5px;">
        </div>


        <input type="color" id="colorPicker" style="margin-left: 20px;">
        <button id="copyColor">Copy Color</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var dragItem = document.querySelector("#grabber");
            var active = false;
            var currentX;
            var currentY;
            var initialX;
            var initialY;
            var xOffset = 0;
            var yOffset = 0;

            // Mouse events
            dragItem.addEventListener("mousedown", dragStart, false);
            document.addEventListener("mouseup", dragEnd, false);
            document.addEventListener("mousemove", drag, false);

            // Touch events
            dragItem.addEventListener("touchstart", dragStart, false);
            document.addEventListener("touchend", dragEnd, false);
            document.addEventListener("touchmove", drag, false);

            function dragStart(e) {
                if (e.type === "touchstart") {
                    // Prevent the default touch action (scroll / zoom)
                    e.preventDefault();

                    // Use the first touch point for the initial position
                    initialX = e.touches[0].clientX - xOffset;
                    initialY = e.touches[0].clientY - yOffset;
                } else {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;
                }

                const hasGrabber = e.target.closest('#grabber');
                if (hasGrabber) {
                    active = true;
                }
            }

            function dragEnd(e) {
                initialX = currentX;
                initialY = currentY;
                active = false;
            }

            function drag(e) {
                if (active) {
                    e.preventDefault();

                    if (e.type === "touchmove") {
                        currentX = e.touches[0].clientX - initialX;
                        currentY = e.touches[0].clientY - initialY;
                    } else {
                        currentX = e.clientX - initialX;
                        currentY = e.clientY - initialY;
                    }

                    xOffset = currentX;
                    yOffset = currentY;

                    setTranslate(currentX, currentY, dragItem);
                }
            }

            function setTranslate(xPos, yPos, el) {
                const dndContainer = el.closest('#colorPickerContainer');
                dndContainer.style.transform = "translate3d(" + xPos + "px, " + yPos + "px, 0)";
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            var colorClasses = [
                'fieldset-color-1', 'fieldset-color-2', 'fieldset-color-3',
                'fieldset-color-4', 'fieldset-color-5', 'fieldset-color-6', 'fieldset-color-7'
            ];
            var fieldsets = document.querySelectorAll('fieldset');
            var colorIndex = 0;

            fieldsets.forEach(function (fieldset) {
                // Apply a color class from the array and increment the index
                fieldset.classList.add(colorClasses[colorIndex]);
                colorIndex = (colorIndex + 1) % colorClasses.length; // Cycle back to the start if we reach the end
            });
        });

        document.getElementById('generateConfigBtn').addEventListener('click', function () {
            const developerNamesInput = document.getElementById('developerNames').value;
            const developerNames = developerNamesInput.split(',').map(name => name.trim()).map(name => `'${name}'`);
            const developerEmail = document.getElementById('developerEmail').value;
            const devOptionsPin = document.getElementById('devOptionsPin').value;

            // Collecting values for the enabled section
            const enabled = {
                versionInfo: {
                    viShowAppInfo: document.getElementById('viShowAppInfo').checked,
                    viShowKtlInfo: document.getElementById('viShowKtlInfo').checked,
                    viShowToRoles: ['Developer'],
                    viPosX: 'right',
                    viPosY: 'top',
                    viPosXMobile: 'center',
                    viPosYMobile: 'bottom',
                    viOpacity: 50,
                    viOpacityHover: 100
                },

                showMenuInTitle: document.getElementById('showMenuInTitle').checked,
                selTextOnFocus: document.getElementById('selTextOnFocus').checked,

                // Continue collecting other flat feature switches
                bulkOps: {
                    bulkEdit: true, // Assuming static for this example
                    bulkCopy: true,
                    bulkDelete: true,
                },
                // Add the rest as per the checkboxes and inputs you've defined
            };

            let versionDisplayName = document.getElementById('versionDisplayName').value;
            let idleWatchDogDelay = document.getElementById('idleWatchDogDelay').value;
            let spinnerCtrDelay = document.getElementById('spinnerCtrDelay').value;
            let spinnerWdExcludeScn = document.getElementById('spinnerWdExcludeScn').value.split(',').map(scn => scn.trim());

            const quickToggleParams = {
                bgColorTrue: document.getElementById('bgColorTrue').value,
                bgColorFalse: document.getElementById('bgColorFalse').value,
                bgColorPending: document.getElementById('bgColorPending').value,
                showSpinner: document.getElementById('showSpinner').checked,
                showNotification: document.getElementById('showNotification').checked,
            };

            const fieldsSettings = {
                textAsNumeric: document.getElementById('textAsNumeric').value.split(',').map(id => id.trim()),
                textAsNumericExcludeScenes: document.getElementById('textAsNumericExcludeScenes').value.split(',').map(id => id.trim()),
                horizontalRadioButtons: document.getElementById('horizontalRadioButtons').checked,
                horizontalCheckboxes: document.getElementById('horizontalCheckboxes').checked,
                barcodeTimeout: parseInt(document.getElementById('barcodeTimeout').value, 10),
                barcodeMinLength: parseInt(document.getElementById('barcodeMinLength').value, 10),
                convertNumToTel: document.getElementById('convertNumToTel').checked,
            };

            const persistentFormsSettings = {
                scenesToExclude: document.getElementById('persistentFormsScenesToExclude').value.split(',').map(id => id.trim()),
                fieldsToExclude: document.getElementById('persistentFormsFieldsToExclude').value.split(',').map(id => id.trim()),
            };

            const addRefreshHtml = document.getElementById('addRefreshHtml').value;
            const addRefreshId = document.getElementById('addRefreshId').value;
            const addRefreshHref = document.getElementById('addRefreshHref').value;

            const logEnabled = {
                critical: document.getElementById('logCritical').checked,
                error: document.getElementById('logError').checked,
                serverErr: document.getElementById('logServerErr').checked,
                warning: document.getElementById('logWarning').checked,
                info: document.getElementById('logInfo').checked,
                debug: document.getElementById('logDebug').checked,
                login: document.getElementById('logLogin').checked,
                activity: document.getElementById('logActivity').checked,
                navigation: document.getElementById('logNavigation').checked,
            };

            // Generating the configuration script
            let configScript = `
                                window.APP_VERSION = '1.0.0';

                                window.ktlReady = function (appInfo = {}) {
                                var ktl = new Ktl($, appInfo);

                                ktl.core.setCfg({
                                developerNames: [${developerNames.join(', ')}],
                                developerEmail: '${developerEmail}',
                                devOptionsPin: '${devOptionsPin}',
                                enabled: {
                                versionInfo: {
                                viShowAppInfo: ${enabled.versionInfo.viShowAppInfo},
                                viShowKtlInfo: ${enabled.versionInfo.viShowKtlInfo},
                                viShowToRoles: ['Developer'],
                                viPosX: '${enabled.versionInfo.viPosX}',
                                viPosY: '${enabled.versionInfo.viPosY}',
                                viPosXMobile: '${enabled.versionInfo.viPosXMobile}',
                                viPosYMobile: '${enabled.versionInfo.viPosYMobile}',
                                viOpacity: ${enabled.versionInfo.viOpacity},
                                viOpacityHover: ${enabled.versionInfo.viOpacityHover}
                                },
                                showMenuInTitle: ${enabled.showMenuInTitle},
                                selTextOnFocus: ${enabled.selTextOnFocus},
                                // Include the rest of the enabled configurations...
                                }
                                });

                                ktl.scenes.setCfg({
                                versionDisplayName: '${versionDisplayName}',
                                idleWatchDogDelay: ${idleWatchDogDelay},
                                spinnerCtrDelay: ${spinnerCtrDelay},
                                spinnerWdExcludeScn: [${spinnerWdExcludeScn.join(',')}],
                                });

                                ktl.views.setCfg({
                                quickToggleParams: {
                                bgColorTrue: '${quickToggleParams.bgColorTrue}',
                                bgColorFalse: '${quickToggleParams.bgColorFalse}',
                                bgColorPending: '${quickToggleParams.bgColorPending}',
                                showSpinner: ${quickToggleParams.showSpinner},
                                showNotification: ${quickToggleParams.showNotification},
                                },
                                headerAlignment: ${document.getElementById('headerAlignment').checked},
                                ktlFlashRate: '${document.getElementById('ktlFlashRate').value}',
                                ktlOutlineColor: '${document.getElementById('ktlOutlineColor').value}',
                                hscCollapsedColumnsWidth: '${document.getElementById('hscCollapsedColumnsWidth').value}',
                                hscGlobal: ${document.getElementById('hscGlobal').checked},
                                });

                                ktl.fields.setCfg({
                                textAsNumeric: [${fieldsSettings.textAsNumeric.join(',')}],
                                textAsNumericExcludeScenes: [${fieldsSettings.textAsNumericExcludeScenes.join(',')}],
                                horizontalRadioButtons: ${fieldsSettings.horizontalRadioButtons},
                                horizontalCheckboxes: ${fieldsSettings.horizontalCheckboxes},
                                barcodeTimeout: ${fieldsSettings.barcodeTimeout},
                                barcodeMinLength: ${fieldsSettings.barcodeMinLength},
                                convertNumToTel: ${fieldsSettings.convertNumToTel},
                                });

                                ktl.persistentForm.setCfg({
                                scenesToExclude: [${persistentFormsSettings.scenesToExclude.join(',')}],
                                fieldsToExclude: [${persistentFormsSettings.fieldsToExclude.join(',')}],
                                });

                                ktl.systemColors.setCfg({
                                inlineEditBkgColor: document.getElementById("inlineEditBkgColor").value,
                                inlineEditFontWeight: document.getElementById("inlineEditFontWeight").value,
                                tableRowHoverBkgColor: document.getElementById("tableRowHoverBkgColor").value,
                                });

                                if (!window.self.frameElement) { //Features that do not apply to the iFrameWnd.
                                ktl.scenes.setCfg({
                                ktlKioskButtons: {
                                ADD_REFRESH: {
                                html: \`${addRefreshHtml}\`,
                                id: '${addRefreshId}',
                                href: ${addRefreshHref},
                                scenesToExclude: [],
                                },
                                ADD_BACK: {
                                // Repeat structure for ADD_BACK
                                },
                                ADD_DONE: {
                                // Repeat structure for ADD_DONE
                                },
                                },
                                });
                                }

                                ktl.log.setCfg({
                                logEnabled: {
                                critical: ${logEnabled.critical},
                                error: ${logEnabled.error},
                                serverErr: ${logEnabled.serverErr},
                                warning: ${logEnabled.warning},
                                info: ${logEnabled.info},
                                debug: ${logEnabled.debug},
                                login: ${logEnabled.login},
                                activity: ${logEnabled.activity},
                                navigation: ${logEnabled.navigation},
                                }
                                });

                                // KTL Setup - END
                                };
                                `;

            // Display the generated configuration script
            document.getElementById('generatedConfig').value = configScript;
        });

        document.getElementById('saveToFileBtn').addEventListener('click', function () {
            // Prompt the user for a filename, providing a default
            let filename = prompt("Enter a filename for your configuration:", "MySetup.ktlcfg");
            if (filename) {
                if (!filename.endsWith('.ktlcfg')) {
                    filename += '.ktlcfg'; // Ensure the file has the correct extension
                }

                // Collect all form inputs here
                const formInputs = {
                    developerNames: document.getElementById('developerNames').value.split(',').map(name => name.trim()),
                    developerEmail: document.getElementById('developerEmail').value,
                    devOptionsPin: document.getElementById('devOptionsPin').value,
                    // Version Info
                    versionInfo: {
                        viShowAppInfo: document.getElementById('viShowAppInfo').checked,
                        viShowKtlInfo: document.getElementById('viShowKtlInfo').checked,
                        viShowToRoles: document.getElementById('viShowToRoles').value.split(',').map(role => role.trim()),
                        viPosX: document.getElementById('viPosX').value,
                        viPosY: document.getElementById('viPosY').value,
                        viPosXMobile: document.getElementById('viPosXMobile').value,
                        viPosYMobile: document.getElementById('viPosYMobile').value,
                        viOpacity: parseInt(document.getElementById('viOpacity').value, 10),
                        viOpacityHover: parseInt(document.getElementById('viOpacityHover').value, 10),
                    },
                    // Feature Switches
                    featureSwitches: {
                        showMenuInTitle: document.getElementById('showMenuInTitle').checked,
                        selTextOnFocus: document.getElementById('selTextOnFocus').checked,
                        inlineEditColor: document.getElementById('inlineEditColor').checked,
                        rowHoverHighlight: document.getElementById('rowHoverHighlight').checked,
                        autoFocus: document.getElementById('autoFocus').checked,
                        sortedMenus: document.getElementById('sortedMenus').checked,
                        userFilters: document.getElementById('userFilters').checked,
                        persistentForm: document.getElementById('persistentForm').checked,
                        calendarGotoDate: document.getElementById('calendarGotoDate').checked,
                        rememberMe: document.getElementById('rememberMe').checked,
                        formPreValidation: document.getElementById('formPreValidation').checked,
                        spinnerWatchDog: document.getElementById('spinnerWatchDog').checked,
                        idleWatchDog: document.getElementById('idleWatchDog').checked,
                        debugWnd: document.getElementById('debugWnd').checked,
                        devInfoPopup: document.getElementById('devInfoPopup').checked,
                        devPauseAutoRefresh: document.getElementById('devPauseAutoRefresh').checked,
                        virtualKeyboard: document.getElementById('virtualKeyboard').checked,
                        iFrameWnd: document.getElementById('iFrameWnd').checked
                    },
                    // Bulk Operations
                    bulkOps: {
                        bulkEdit: document.getElementById('bulkEdit').checked,
                        bulkCopy: document.getElementById('bulkCopy').checked,
                        bulkDelete: document.getElementById('bulkDelete').checked
                    },
                    // Popup Style Settings
                    popupStyle: {
                        success: document.getElementById('popupStyleSuccess').value,
                        warning: document.getElementById('popupStyleWarning').value,
                        error: document.getElementById('popupStyleError').value
                    },
                    // Tooltip Styles Settings
                    tooltipStyles: {
                        ktlTtipFormViewBgColor: document.getElementById('ktlTtipFormViewBgColor').value,
                        ktlTtipFormViewTxtColor: document.getElementById('ktlTtipFormViewTxtColor').value,
                        ktlTtipIconFormViewColor: document.getElementById('ktlTtipIconFormViewColor').value,
                        ktlTtipDetailsViewBgColor: document.getElementById('ktlTtipDetailsViewBgColor').value,
                        ktlTtipDetailsViewTxtColor: document.getElementById('ktlTtipDetailsViewTxtColor').value,
                        ktlTtipIconDetailsViewColor: document.getElementById('ktlTtipIconDetailsViewColor').value,
                        ktlTtipTableViewBgColor: document.getElementById('ktlTtipTableViewBgColor').value,
                        ktlTtipTableViewTxtColor: document.getElementById('ktlTtipTableViewTxtColor').value,
                        ktlTtipIconTableViewColor: document.getElementById('ktlTtipIconTableViewColor').value
                    },
                    // Scenes Settings
                    scenesSettings: {
                        versionDisplayName: document.getElementById('versionDisplayName').value,
                        idleWatchDogDelay: parseInt(document.getElementById('idleWatchDogDelay').value),
                        spinnerCtrDelay: parseInt(document.getElementById('spinnerCtrDelay').value),
                        spinnerWdExcludeScn: document.getElementById('spinnerWdExcludeScn').value.split(',').map(scn => scn.trim())
                    },
                    // Views Settings
                    viewsSettings: {
                        quickToggleParams: {
                            bgColorTrue: document.getElementById('bgColorTrue').value,
                            bgColorFalse: document.getElementById('bgColorFalse').value,
                            bgColorPending: document.getElementById('bgColorPending').value,
                            showSpinner: document.getElementById('showSpinner').checked,
                            showNotification: document.getElementById('showNotification').checked
                        },
                        headerAlignment: document.getElementById('headerAlignment').checked,
                        ktlFlashRate: document.getElementById('ktlFlashRate').value,
                        ktlOutlineColor: document.getElementById('ktlOutlineColor').value,
                        hscCollapsedColumnsWidth: document.getElementById('hscCollapsedColumnsWidth').value,
                        hscGlobal: document.getElementById('hscGlobal').checked
                    },
                    // Fields Settings
                    fieldsSettings: {
                        textAsNumeric: document.getElementById('textAsNumeric').value.split(',').map(id => id.trim()),
                        textAsNumericExcludeScenes: document.getElementById('textAsNumericExcludeScenes').value.split(',').map(id => id.trim()),
                        horizontalRadioButtons: document.getElementById('horizontalRadioButtons').checked,
                        horizontalCheckboxes: document.getElementById('horizontalCheckboxes').checked,
                        barcodeTimeout: parseInt(document.getElementById('barcodeTimeout').value),
                        barcodeMinLength: parseInt(document.getElementById('barcodeMinLength').value),
                        convertNumToTel: document.getElementById('convertNumToTel').checked
                    },
                    // Persistent Forms Settings
                    persistentFormsSettings: {
                        scenesToExclude: document.getElementById('persistentFormsScenesToExclude').value.split(',').map(id => id.trim()),
                        fieldsToExclude: document.getElementById('persistentFormsFieldsToExclude').value.split(',').map(id => id.trim())
                    },
                    // System Colors Settings
                    systemColorsSettings: {
                        inlineEditBkgColor: document.getElementById('inlineEditBkgColor').value,
                        inlineEditFontWeight: document.getElementById('inlineEditFontWeight').value,
                        tableRowHoverBkgColor: document.getElementById('tableRowHoverBkgColor').value
                    },
                    // Advanced Settings: Kiosk Settings
                    kioskSettings: {
                        ADD_REFRESH: {
                            html: document.getElementById('addRefreshHtml').value,
                            id: document.getElementById('addRefreshId').value,
                            href: document.getElementById('addRefreshHref').value
                        },
                        ADD_BACK: {
                            html: document.getElementById('addBackHtml').value,
                            id: document.getElementById('addBackId').value,
                            href: document.getElementById('addBackHref').value
                        },
                        ADD_DONE: {
                            html: document.getElementById('addDoneHtml').value,
                            id: document.getElementById('addDoneId').value,
                            href: document.getElementById('addDoneHref').value
                        }
                    },
                    // Logging Settings
                    loggingSettings: {
                        critical: document.getElementById('logCritical').checked,
                        error: document.getElementById('logError').checked,
                        serverErr: document.getElementById('logServerErr').checked,
                        warning: document.getElementById('logWarning').checked,
                        info: document.getElementById('logInfo').checked,
                        debug: document.getElementById('logDebug').checked,
                        login: document.getElementById('logLogin').checked,
                        activity: document.getElementById('logActivity').checked,
                        navigation: document.getElementById('logNavigation').checked
                    },
                    // iFrameWnd Settings
                    iFrameWndSettings: {
                        sendHeartbeat: document.getElementById('sendHeartbeat').checked
                    }
                }; //Save File

                // Convert form data to a JSON string
                const dataStr = JSON.stringify(formInputs, null, 4);
                const blob = new Blob([dataStr], { type: "application/json" });

                // Create a link and trigger download
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            } else {
                alert("File save cancelled.");
            }
        });

        document.getElementById('loadFromFileBtn').addEventListener('click', function () {
            // Programmatically click the hidden file input
            document.getElementById('fileInput').click();
        });

        document.getElementById('fileInput').addEventListener('change', function (event) {
            const file = event.target.files[0];
            if (file) {
                // Create a FileReader to read the selected file
                const reader = new FileReader();
                reader.onload = function (fileLoadEvent) {
                    const contents = fileLoadEvent.target.result;

                    // Try parsing the JSON contents and populating the form
                    try {
                        const config = JSON.parse(contents);
                        if (config) {
                            // Populate the form with loaded configuration
                            document.getElementById('developerNames').value = config.developerNames.join(', ');
                            document.getElementById('developerEmail').value = config.developerEmail;
                            document.getElementById('devOptionsPin').value = config.devOptionsPin;
                            // Version Info
                            document.getElementById('viShowAppInfo').checked = config.versionInfo.viShowAppInfo;
                            document.getElementById('viShowKtlInfo').checked = config.versionInfo.viShowKtlInfo;
                            document.getElementById('viShowToRoles').value = config.versionInfo.viShowToRoles.join(', ');
                            document.getElementById('viPosX').value = config.versionInfo.viPosX;
                            document.getElementById('viPosY').value = config.versionInfo.viPosY;
                            document.getElementById('viPosXMobile').value = config.versionInfo.viPosXMobile;
                            document.getElementById('viPosYMobile').value = config.versionInfo.viPosYMobile;
                            document.getElementById('viOpacity').value = config.versionInfo.viOpacity;
                            document.getElementById('viOpacityHover').value = config.versionInfo.viOpacityHover;
                            // Handle additional configurations as necessary...

                            // Feature Switches and other settings
                            Object.keys(config.featureSwitches).forEach(key => {
                                const checkbox = document.getElementById(key);
                                if (checkbox) checkbox.checked = config.featureSwitches[key];
                            });

                            // Bulk Operations
                            Object.keys(config.bulkOps).forEach(key => {
                                const checkbox = document.getElementById(key);
                                if (checkbox) checkbox.checked = config.bulkOps[key];
                            });

                            // Popup Style
                            document.getElementById('popupStyleSuccess').value = config.popupStyle.success;
                            document.getElementById('popupStyleWarning').value = config.popupStyle.warning;
                            document.getElementById('popupStyleError').value = config.popupStyle.error;

                            // Tooltip Styles
                            Object.keys(config.tooltipStyles).forEach(key => {
                                document.getElementById(key).value = config.tooltipStyles[key];
                            });

                            // Scenes Settings
                            document.getElementById('versionDisplayName').value = config.scenesSettings.versionDisplayName;
                            document.getElementById('idleWatchDogDelay').value = config.scenesSettings.idleWatchDogDelay;
                            document.getElementById('spinnerCtrDelay').value = config.scenesSettings.spinnerCtrDelay;
                            document.getElementById('spinnerWdExcludeScn').value = config.scenesSettings.spinnerWdExcludeScn.join(', ');

                            // Views Settings
                            const qtParams = config.viewsSettings.quickToggleParams;
                            document.getElementById('bgColorTrue').value = qtParams.bgColorTrue;
                            document.getElementById('bgColorFalse').value = qtParams.bgColorFalse;
                            document.getElementById('bgColorPending').value = qtParams.bgColorPending;
                            document.getElementById('showSpinner').checked = qtParams.showSpinner;
                            document.getElementById('showNotification').checked = qtParams.showNotification;
                            document.getElementById('headerAlignment').checked = config.viewsSettings.headerAlignment;
                            document.getElementById('ktlFlashRate').value = config.viewsSettings.ktlFlashRate;
                            document.getElementById('ktlOutlineColor').value = config.viewsSettings.ktlOutlineColor;
                            document.getElementById('hscCollapsedColumnsWidth').value = config.viewsSettings.hscCollapsedColumnsWidth;
                            document.getElementById('hscGlobal').checked = config.viewsSettings.hscGlobal;

                            // Fields Settings
                            document.getElementById('textAsNumeric').value = config.fieldsSettings.textAsNumeric.join(', ');
                            document.getElementById('textAsNumericExcludeScenes').value = config.fieldsSettings.textAsNumericExcludeScenes.join(', ');
                            document.getElementById('horizontalRadioButtons').checked = config.fieldsSettings.horizontalRadioButtons;
                            document.getElementById('horizontalCheckboxes').checked = config.fieldsSettings.horizontalCheckboxes;
                            document.getElementById('barcodeTimeout').value = config.fieldsSettings.barcodeTimeout;
                            document.getElementById('barcodeMinLength').value = config.fieldsSettings.barcodeMinLength;
                            document.getElementById('convertNumToTel').checked = config.fieldsSettings.convertNumToTel;

                            // Persistent Forms Settings
                            document.getElementById('persistentFormsScenesToExclude').value = config.persistentFormsSettings.scenesToExclude.join(', ');
                            document.getElementById('persistentFormsFieldsToExclude').value = config.persistentFormsSettings.fieldsToExclude.join(', ');

                            // System Colors Settings
                            document.getElementById('inlineEditBkgColor').value = config.systemColorsSettings.inlineEditBkgColor;
                            document.getElementById('inlineEditFontWeight').value = config.systemColorsSettings.inlineEditFontWeight;
                            document.getElementById('tableRowHoverBkgColor').value = config.systemColorsSettings.tableRowHoverBkgColor;

                            // Advanced Settings: Kiosk
                            if (config.advancedSettings && config.advancedSettings.kioskSettings) {
                                document.getElementById('addRefreshHtml').value = config.advancedSettings.kioskSettings.ADD_REFRESH.html;
                                document.getElementById('addRefreshId').value = config.advancedSettings.kioskSettings.ADD_REFRESH.id;
                                document.getElementById('addRefreshHref').value = config.advancedSettings.kioskSettings.ADD_REFRESH.href;

                                document.getElementById('addBackHtml').value = config.advancedSettings.kioskSettings.ADD_BACK.html;
                                document.getElementById('addBackId').value = config.advancedSettings.kioskSettings.ADD_BACK.id;
                                document.getElementById('addBackHref').value = config.advancedSettings.kioskSettings.ADD_BACK.href;

                                document.getElementById('addDoneHtml').value = config.advancedSettings.kioskSettings.ADD_DONE.html;
                                document.getElementById('addDoneId').value = config.advancedSettings.kioskSettings.ADD_DONE.id;
                                document.getElementById('addDoneHref').value = config.advancedSettings.kioskSettings.ADD_DONE.href;
                            }

                            // Advanced Settings: Logging
                            if (config.advancedSettings && config.advancedSettings.loggingSettings) {
                                Object.keys(config.advancedSettings.loggingSettings.logEnabled).forEach(key => {
                                    const checkbox = document.getElementById(key);
                                    if (checkbox) checkbox.checked = config.advancedSettings.loggingSettings.logEnabled[key];
                                });
                            }

                            // Advanced Settings: iFrameWnd
                            if (config.advancedSettings && config.advancedSettings.iFrameWndSettings) {
                                document.getElementById('sendHeartbeat').checked = config.advancedSettings.iFrameWndSettings.sendHeartbeat;
                            }


                            // Handle developerNames differently based on its type
                            if (Array.isArray(config.developerNames)) {
                                document.getElementById('developerNames').value = config.developerNames.join(', ');
                            } else {
                                alert('Error - developerNames not an array.');
                            }

                            // Populate other form fields
                            document.getElementById('developerEmail').value = config.developerEmail || '';
                            document.getElementById('devOptionsPin').value = config.devOptionsPin || '';
                            // Repeat for other fields as necessary
                        } //Load File
                    } catch (error) {
                        alert('Error reading file: ' + error.message);
                    }
                };
                reader.readAsText(file);
            }
        });

        document.getElementById('copyColor').addEventListener('click', function () {
            var color = document.getElementById('colorPicker').value;
            navigator.clipboard.writeText(color).then(function () {
                // Create a confirmation message
                var confirmationMsg = document.createElement("div");
                confirmationMsg.textContent = 'Copied to clipboard: ' + color;
                confirmationMsg.style.position = "absolute";
                confirmationMsg.style.left = 0;
                confirmationMsg.style.bottom = "60px";
                confirmationMsg.style.backgroundColor = "#f0f0f0";
                confirmationMsg.style.padding = "5px";
                confirmationMsg.style.borderRadius = "5px";
                confirmationMsg.style.boxShadow = "0 2px 4px rgba(0,0,0,0.2)";
                confirmationMsg.style.fontSize = "0.8rem";
                confirmationMsg.style.zIndex = 1000; // Ensure it's above other elements

                // Append the message to the color picker container
                var container = document.getElementById('colorPickerContainer');
                container.appendChild(confirmationMsg);

                // Remove the message after 2 seconds
                setTimeout(function () {
                    container.removeChild(confirmationMsg);
                }, 2000);
            }, function (err) {
                console.error('Could not copy color: ', err);
            });
        });

    </script>


    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</body>
</html>
